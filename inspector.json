{
  "$schema": "https://modelcontextprotocol.io/schemas/inspector.schema.json",
  "name": "ServalSheets MCP Server",
  "description": "Production-grade Google Sheets MCP server with 25 tools, 195 actions, AI-powered features (Sampling/Elicitation), safety rails, and enterprise features",
  "version": "1.3.0",
  "mcpServers": {
    "servalsheets": {
      "command": "node",
      "args": ["dist/cli.js", "--stdio"],
      "env": {
        "NODE_ENV": "development",
        "LOG_LEVEL": "info",
        "CIRCUIT_BREAKER_ENABLED": "true",
        "CACHE_ENABLED": "true",
        "REQUEST_DEDUPLICATION_ENABLED": "true",
        "RESULT_CACHE_ENABLED": "true",
        "GOOGLE_TOKEN_STORE_PATH": "/Users/thomascahill/.config/servalsheets/tokens.enc",
        "ALLOWED_ROOT_DIRS": "/Users/thomascahill/Documents,/Users/thomascahill/Downloads,/tmp"
      },
      "metadata": {
        "author": "Thomas Lee Cahill",
        "repository": "https://github.com/khill1269/servalsheets",
        "documentation": "https://github.com/khill1269/servalsheets#readme",
        "mcpProtocol": "2025-11-25",
        "capabilities": ["tools", "resources", "prompts", "logging", "completions", "tasks", "elicitation", "sampling"],
        "toolCount": 25,
        "actionCount": 195
      }
    }
  },
  "defaultServer": "servalsheets",
  "ui": {
    "theme": "dark",
    "showMetadata": true,
    "showTimestamps": true,
    "autoConnect": true
  },
  "metadata": {
    "testEnvironment": "development",
    "purpose": "MCP Inspector testing and tool validation",
    "testSpreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
    "notes": "Replace YOUR_TEST_SPREADSHEET_ID_HERE with an actual spreadsheet ID for testing"
  },
  "testing": {
    "sampleRequests": [
      {
        "name": "üîê Auth: Check Status (No Auth Required)",
        "description": "Check current authentication status - works without OAuth",
        "tool": "sheets_auth",
        "category": "authentication",
        "requiresAuth": false,
        "arguments": {
          "action": "status"
        },
        "expectedBehavior": "Returns authentication status, token location, and setup instructions"
      },
      {
        "name": "üîê Auth: Start OAuth Flow",
        "description": "Initiate OAuth authentication flow - opens browser",
        "tool": "sheets_auth",
        "category": "authentication",
        "requiresAuth": false,
        "arguments": {
          "action": "login"
        },
        "expectedBehavior": "Returns authUrl to complete OAuth flow in browser"
      },
      {
        "name": "üìä Spreadsheet: Get Metadata",
        "description": "Retrieve spreadsheet properties and structure",
        "tool": "sheets_spreadsheet",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "get",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE"
        },
        "expectedBehavior": "Returns spreadsheet title, sheets, properties, and metadata"
      },
      {
        "name": "üìÑ Sheet: List All Sheets",
        "description": "List all sheets (tabs) in a spreadsheet",
        "tool": "sheets_sheet",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "list",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE"
        },
        "expectedBehavior": "Returns array of sheets with names, IDs, and properties"
      },
      {
        "name": "üìñ Values: Read Range",
        "description": "Read cell values from a spreadsheet range",
        "tool": "sheets_values",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "read",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1:D10" }
        },
        "expectedBehavior": "Returns 2D array of cell values"
      },
      {
        "name": "‚úçÔ∏è Values: Write with Dry Run (Safe)",
        "description": "Preview write operation without executing - tests safety features",
        "tool": "sheets_values",
        "category": "safety",
        "requiresAuth": true,
        "arguments": {
          "action": "write",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1:B2" },
          "values": [
            ["Header 1", "Header 2"],
            ["Test Value 1", "Test Value 2"]
          ],
          "safety": {
            "dryRun": true,
            "createSnapshot": true
          }
        },
        "expectedBehavior": "Returns preview of changes WITHOUT executing - shows what would happen"
      },
      {
        "name": "üîç Analysis: Data Quality Check",
        "description": "Analyze data quality issues (duplicates, empty cells, mixed types)",
        "tool": "sheets_analysis",
        "category": "analytics",
        "requiresAuth": true,
        "arguments": {
          "action": "data_quality",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1:Z100" }
        },
        "expectedBehavior": "Returns data quality report with issues, severity, and suggested fixes"
      },
      {
        "name": "üîç Analysis: Formula Audit",
        "description": "Audit formulas for errors and performance issues",
        "tool": "sheets_analysis",
        "category": "analytics",
        "requiresAuth": true,
        "arguments": {
          "action": "formula_audit",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE"
        },
        "expectedBehavior": "Returns formula errors, broken refs, volatile functions, and optimization suggestions"
      },
      {
        "name": "üé® Format: Apply Cell Formatting",
        "description": "Apply colors, fonts, and borders to cells",
        "tool": "sheets_format",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "set_colors",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1:D1" },
          "backgroundColor": { "red": 0.26, "green": 0.52, "blue": 0.96 },
          "foregroundColor": { "red": 1.0, "green": 1.0, "blue": 1.0 }
        },
        "expectedBehavior": "Applies blue background and white text to header row"
      },
      {
        "name": "üßÆ Transaction: Begin + Queue + Commit",
        "description": "Execute multiple operations atomically (80% fewer API calls)",
        "tool": "sheets_transaction",
        "category": "enterprise",
        "requiresAuth": true,
        "arguments": {
          "action": "begin",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "autoRollback": true
        },
        "expectedBehavior": "Returns transactionId for queuing operations. Then call 'queue' repeatedly, finally 'commit'"
      },
      {
        "name": "üìú History: List Operations",
        "description": "View operation history and audit trail (No Auth Required)",
        "tool": "sheets_history",
        "category": "enterprise",
        "requiresAuth": false,
        "arguments": {
          "action": "list",
          "limit": 10
        },
        "expectedBehavior": "Returns recent operations with timestamps and details"
      },
      {
        "name": "‚úÖ Confirm: Get Stats (MCP Elicitation Test)",
        "description": "Test MCP Elicitation support - user confirmation stats",
        "tool": "sheets_confirm",
        "category": "mcp-native",
        "requiresAuth": false,
        "mcpFeature": "elicitation",
        "arguments": {
          "action": "get_stats"
        },
        "expectedBehavior": "Returns confirmation statistics (approved/rejected operations)"
      },
      {
        "name": "‚úÖ Confirm: Request User Approval (MCP Elicitation Demo)",
        "description": "Demo MCP Elicitation - interactive user confirmation UI",
        "tool": "sheets_confirm",
        "category": "mcp-native",
        "requiresAuth": false,
        "mcpFeature": "elicitation",
        "arguments": {
          "action": "request",
          "plan": {
            "title": "Test Operation Plan",
            "description": "Demo: Delete 10 test rows from Sheet1",
            "steps": [
              {
                "stepNumber": 1,
                "description": "Identify rows to delete",
                "tool": "sheets_values",
                "action": "read",
                "risk": "low",
                "estimatedApiCalls": 1,
                "isDestructive": false,
                "canUndo": true
              },
              {
                "stepNumber": 2,
                "description": "Delete 10 rows",
                "tool": "sheets_dimensions",
                "action": "delete_rows",
                "risk": "high",
                "estimatedApiCalls": 1,
                "isDestructive": true,
                "canUndo": true
              }
            ],
            "totalSteps": 2,
            "estimatedApiCalls": 2,
            "estimatedDuration": "5 seconds",
            "willCreateSnapshot": true,
            "additionalWarnings": ["This will permanently delete rows unless snapshot is created"]
          }
        },
        "expectedBehavior": "Opens interactive UI for user to approve/reject/modify the plan"
      },
      {
        "name": "ü§ñ Analyze: Generate Formula (MCP Sampling Test)",
        "description": "Test MCP Sampling - AI generates Google Sheets formula from natural language",
        "tool": "sheets_analyze",
        "category": "mcp-native",
        "requiresAuth": true,
        "mcpFeature": "sampling",
        "arguments": {
          "action": "generate_formula",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "description": "Calculate year-over-year growth percentage comparing this year (column B) to last year (column C)",
          "range": { "a1": "Sheet1!A1:C100" }
        },
        "expectedBehavior": "AI generates formula like '=(B2-C2)/C2*100', explains how it works, provides alternatives"
      },
      {
        "name": "ü§ñ Analyze: Detect Patterns (MCP Sampling Demo)",
        "description": "Demo MCP Sampling - AI finds patterns, trends, and anomalies in data",
        "tool": "sheets_analyze",
        "category": "mcp-native",
        "requiresAuth": true,
        "mcpFeature": "sampling",
        "arguments": {
          "action": "analyze",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1:F100" },
          "analysisTypes": ["patterns", "anomalies", "trends"]
        },
        "expectedBehavior": "AI detects trends (increasing/decreasing), anomalies (outliers), and patterns (seasonality)"
      },
      {
        "name": "ü§ñ Analyze: Suggest Chart Type",
        "description": "AI recommends best chart types for your data",
        "tool": "sheets_analyze",
        "category": "mcp-native",
        "requiresAuth": true,
        "mcpFeature": "sampling",
        "arguments": {
          "action": "suggest_chart",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1:D20" },
          "goal": "Show revenue trends over time by product category"
        },
        "expectedBehavior": "AI suggests chart types (line, bar, stacked) with reasoning and configuration"
      },
      {
        "name": "üîß Fix: Auto-Repair Issues (MCP Automated)",
        "description": "Automatically fix common data quality and formula issues",
        "tool": "sheets_fix",
        "category": "mcp-native",
        "requiresAuth": true,
        "arguments": {
          "action": "preview",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "mode": "preview",
          "issues": [
            {
              "type": "MULTIPLE_TODAY",
              "severity": "medium",
              "location": "Sheet1!B2:B100"
            }
          ]
        },
        "expectedBehavior": "Shows what fixes would be applied (use mode: 'apply' to execute)"
      },
      {
        "name": "‚úîÔ∏è Validation: Pre-Flight Check",
        "description": "Validate operation before execution - catch errors early",
        "tool": "sheets_validation",
        "category": "enterprise",
        "requiresAuth": true,
        "arguments": {
          "action": "validate",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "operations": [
            {
              "tool": "sheets_values",
              "action": "write",
              "args": {
                "range": { "a1": "Sheet1!A1:D100" }
              }
            }
          ]
        },
        "expectedBehavior": "Returns validation result (success/failure) with detailed errors if any"
      },
      {
        "name": "‚ö†Ô∏è Conflict: Detect Concurrent Changes",
        "description": "Detect conflicts from concurrent modifications",
        "tool": "sheets_conflict",
        "category": "enterprise",
        "requiresAuth": true,
        "arguments": {
          "action": "detect",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "ranges": [{ "a1": "Sheet1!A1:D10" }]
        },
        "expectedBehavior": "Returns detected conflicts or NO_CONFLICTS if clear to proceed"
      },
      {
        "name": "üìä Impact: Analyze Change Impact",
        "description": "Preview impact of changes before execution",
        "tool": "sheets_impact",
        "category": "enterprise",
        "requiresAuth": true,
        "arguments": {
          "action": "analyze",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!B2:B100" },
          "changeType": "delete"
        },
        "expectedBehavior": "Returns affected formulas, dependent cells, and cascading changes"
      },
      {
        "name": "Ô∏è Resources: Cache Stats",
        "description": "View MCP resource - cache performance metrics",
        "type": "readResource",
        "uri": "cache://stats",
        "category": "resources",
        "requiresAuth": false,
        "expectedBehavior": "Returns cache hit rate, size, and performance metrics"
      },
      {
        "name": "üóÇÔ∏è Resources: Deduplication Stats",
        "description": "View MCP resource - request deduplication metrics",
        "type": "readResource",
        "uri": "cache://deduplication",
        "category": "resources",
        "requiresAuth": false,
        "expectedBehavior": "Returns API call reduction stats from deduplication"
      },
      {
        "name": "üìä Spreadsheet: Create New",
        "description": "Create a brand new spreadsheet",
        "tool": "sheets_spreadsheet",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "create",
          "title": "My New Spreadsheet"
        },
        "expectedBehavior": "Returns new spreadsheet ID and URL"
      },
      {
        "name": "üìä Spreadsheet: Copy Existing",
        "description": "Make a copy of an existing spreadsheet",
        "tool": "sheets_spreadsheet",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "copy",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "title": "Copy of My Spreadsheet"
        },
        "expectedBehavior": "Returns copied spreadsheet ID and URL"
      },
      {
        "name": "üìÑ Sheet: Add New Sheet",
        "description": "Add a new sheet (tab) to spreadsheet",
        "tool": "sheets_sheet",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "add",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "title": "New Data Sheet"
        },
        "expectedBehavior": "Returns new sheet ID and properties"
      },
      {
        "name": "üìÑ Sheet: Delete Sheet",
        "description": "Delete a sheet by ID (use with caution)",
        "tool": "sheets_sheet",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "delete",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "sheetId": 123456
        },
        "expectedBehavior": "Confirms sheet deletion"
      },
      {
        "name": "üìÑ Sheet: Duplicate Sheet",
        "description": "Create a copy of an existing sheet",
        "tool": "sheets_sheet",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "duplicate",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "sourceSheetId": 0
        },
        "expectedBehavior": "Returns duplicated sheet ID"
      },
      {
        "name": "üìñ Values: Append Rows",
        "description": "Append new rows to the end of a sheet",
        "tool": "sheets_values",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "append",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1" },
          "values": [
            ["New Row 1 Col A", "New Row 1 Col B"],
            ["New Row 2 Col A", "New Row 2 Col B"]
          ]
        },
        "expectedBehavior": "Appends rows after last row with data"
      },
      {
        "name": "üìñ Values: Batch Read Multiple Ranges",
        "description": "Read multiple ranges in a single request (efficient)",
        "tool": "sheets_values",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "batch_read",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "ranges": [
            { "a1": "Sheet1!A1:B2" },
            { "a1": "Sheet1!D1:E2" }
          ]
        },
        "expectedBehavior": "Returns data from both ranges"
      },
      {
        "name": "üìñ Values: Find and Replace",
        "description": "Find and replace text across ranges",
        "tool": "sheets_values",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "find",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1:Z1000" },
          "searchText": "old value"
        },
        "expectedBehavior": "Returns cells containing search text"
      },
      {
        "name": "üîó Cells: Merge Header Row",
        "description": "Merge cells A1:D1 for a centered header",
        "tool": "sheets_cells",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "merge",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1:D1" },
          "mergeType": "MERGE_ALL"
        },
        "expectedBehavior": "Merges cells into single cell"
      },
      {
        "name": "üìù Cells: Add Note to Cell",
        "description": "Add a note (comment-like annotation) to a cell",
        "tool": "sheets_cells",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "add_note",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1" },
          "note": "Data validated on 2024-01-06"
        },
        "expectedBehavior": "Adds note to cell (visible on hover)"
      },
      {
        "name": "üîó Cells: Set Hyperlink",
        "description": "Convert cell text to clickable hyperlink",
        "tool": "sheets_cells",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "set_hyperlink",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1" },
          "url": "https://example.com"
        },
        "expectedBehavior": "Makes cell text a clickable link"
      },
      {
        "name": "üé® Format: Set Font Style",
        "description": "Apply bold, italic, size to text",
        "tool": "sheets_format",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "set_font",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1:D1" },
          "bold": true,
          "fontSize": 12
        },
        "expectedBehavior": "Makes header row bold and 12pt"
      },
      {
        "name": "üé® Format: Apply Borders",
        "description": "Add borders around cells",
        "tool": "sheets_format",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "set_borders",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1:D10" },
          "style": "SOLID",
          "width": 1
        },
        "expectedBehavior": "Adds borders to range"
      },
      {
        "name": "üé® Format: Number Formatting",
        "description": "Format numbers as currency, percentage, date",
        "tool": "sheets_format",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "set_number_format",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!B2:B100" },
          "format": "$#,##0.00"
        },
        "expectedBehavior": "Formats numbers as USD currency"
      },
      {
        "name": "‚ûï Dimensions: Insert 5 Rows",
        "description": "Insert empty rows at specific position",
        "tool": "sheets_dimensions",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "insert_rows",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "sheetId": 0,
          "startIndex": 5,
          "count": 5
        },
        "expectedBehavior": "Inserts 5 empty rows starting at row 6"
      },
      {
        "name": "‚ùå Dimensions: Delete Rows (DRY RUN)",
        "description": "Preview row deletion without executing",
        "tool": "sheets_dimensions",
        "category": "safety",
        "requiresAuth": true,
        "arguments": {
          "action": "delete_rows",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "sheetId": 0,
          "startIndex": 10,
          "count": 2,
          "safety": {
            "dryRun": true,
            "createSnapshot": true
          }
        },
        "expectedBehavior": "Shows what would be deleted (doesn't delete)"
      },
      {
        "name": "‚ùÑÔ∏è Dimensions: Freeze Top Row",
        "description": "Freeze header row for scrolling",
        "tool": "sheets_dimensions",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "freeze_rows",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "sheetId": 0,
          "count": 1
        },
        "expectedBehavior": "Freezes row 1 (stays visible when scrolling)"
      },
      {
        "name": "üìè Dimensions: Auto-Resize Columns",
        "description": "Auto-fit column widths to content",
        "tool": "sheets_dimensions",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "auto_resize",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "sheetId": 0,
          "dimension": "COLUMNS",
          "startIndex": 0,
          "endIndex": 10
        },
        "expectedBehavior": "Resizes columns A-J to fit content"
      },
      {
        "name": "üé® Rules: Conditional Format (Color Scale)",
        "description": "Apply color gradient based on cell values",
        "tool": "sheets_rules",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "add_conditional_format",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!B2:B100" },
          "type": "COLOR_SCALE",
          "minColor": { "red": 1.0, "green": 0.0, "blue": 0.0 },
          "maxColor": { "red": 0.0, "green": 1.0, "blue": 0.0 }
        },
        "expectedBehavior": "Colors cells from red (low) to green (high)"
      },
      {
        "name": "‚úÖ Rules: Add Dropdown Validation",
        "description": "Add dropdown list for data validation",
        "tool": "sheets_rules",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "add_validation",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!C2:C100" },
          "type": "LIST",
          "values": ["High", "Medium", "Low"]
        },
        "expectedBehavior": "Creates dropdown with 3 priority options"
      },
      {
        "name": "üìà Charts: Create Line Chart",
        "description": "Create line chart for trend visualization",
        "tool": "sheets_charts",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "create",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "sheetId": 0,
          "type": "LINE",
          "range": { "a1": "Sheet1!A1:B10" },
          "title": "Sales Trend Over Time"
        },
        "expectedBehavior": "Creates embedded line chart"
      },
      {
        "name": "ü•ß Charts: Create Pie Chart",
        "description": "Create pie chart for proportional data",
        "tool": "sheets_charts",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "create",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "sheetId": 0,
          "type": "PIE",
          "range": { "a1": "Sheet1!A1:B6" },
          "title": "Market Share by Category"
        },
        "expectedBehavior": "Creates embedded pie chart"
      },
      {
        "name": "üîç Filter: Create Basic Filter",
        "description": "Filter rows based on column value",
        "tool": "sheets_filter_sort",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "set_filter",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1:D100" },
          "column": 0,
          "condition": "TEXT_EQ",
          "values": ["Active"]
        },
        "expectedBehavior": "Shows only rows where column A = 'Active'"
      },
      {
        "name": "‚¨áÔ∏è Sort: Sort by Date Descending",
        "description": "Sort data by column (newest first)",
        "tool": "sheets_filter_sort",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "sort_range",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A2:D100" },
          "sortColumn": 0,
          "ascending": false
        },
        "expectedBehavior": "Sorts data by column A descending"
      },
      {
        "name": "ü§ù Sharing: Share with User",
        "description": "Share spreadsheet with specific user",
        "tool": "sheets_sharing",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "share",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "email": "user@example.com",
          "role": "reader"
        },
        "expectedBehavior": "Grants read access to user"
      },
      {
        "name": "üîó Sharing: Get Shareable Link",
        "description": "Generate link for anyone with link",
        "tool": "sheets_sharing",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "get_link",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "access": "anyone"
        },
        "expectedBehavior": "Returns shareable URL"
      },
      {
        "name": "üí¨ Comments: Add Comment",
        "description": "Add threaded comment to cell",
        "tool": "sheets_comments",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "add",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1" },
          "text": "Please review this data"
        },
        "expectedBehavior": "Adds comment thread to cell"
      },
      {
        "name": "üí¨ Comments: Reply to Thread",
        "description": "Reply to existing comment",
        "tool": "sheets_comments",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "reply",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "commentId": "COMMENT_ID_FROM_ADD",
          "text": "Reviewed and approved"
        },
        "expectedBehavior": "Adds reply to comment thread"
      },
      {
        "name": "‚úîÔ∏è Comments: Resolve Thread",
        "description": "Mark comment thread as resolved",
        "tool": "sheets_comments",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "resolve",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "commentId": "COMMENT_ID_FROM_ADD"
        },
        "expectedBehavior": "Marks comment as resolved"
      },
      {
        "name": "üì∏ Versions: Create Snapshot",
        "description": "Create restore point before major changes",
        "tool": "sheets_versions",
        "category": "safety",
        "requiresAuth": true,
        "arguments": {
          "action": "create_snapshot",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "description": "Before bulk data import"
        },
        "expectedBehavior": "Creates named snapshot for rollback"
      },
      {
        "name": "üìú Versions: List Revisions",
        "description": "View spreadsheet version history",
        "tool": "sheets_versions",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "list_revisions",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "limit": 10
        },
        "expectedBehavior": "Returns last 10 revision snapshots"
      },
      {
        "name": "‚èÆÔ∏è Versions: Restore Snapshot",
        "description": "Rollback to previous version",
        "tool": "sheets_versions",
        "category": "safety",
        "requiresAuth": true,
        "arguments": {
          "action": "restore",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "revisionId": "REVISION_ID_FROM_LIST"
        },
        "expectedBehavior": "Restores spreadsheet to snapshot state"
      },
      {
        "name": "üìä Analysis: Statistics Summary",
        "description": "Get statistical summary of numeric columns",
        "tool": "sheets_analysis",
        "category": "analytics",
        "requiresAuth": true,
        "arguments": {
          "action": "statistics",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!B2:B100" }
        },
        "expectedBehavior": "Returns mean, median, std dev, min, max"
      },
      {
        "name": "üìä Analysis: Column Analysis",
        "description": "Analyze column data types and distributions",
        "tool": "sheets_analysis",
        "category": "analytics",
        "requiresAuth": true,
        "arguments": {
          "action": "column_analysis",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A:Z" }
        },
        "expectedBehavior": "Returns type detection, unique counts, frequency"
      },
      {
        "name": "üîí Advanced: Add Named Range",
        "description": "Create named range for formulas",
        "tool": "sheets_advanced",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "add_named_range",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "name": "SalesData",
          "range": { "a1": "Sheet1!B2:B100" }
        },
        "expectedBehavior": "Creates named range 'SalesData'"
      },
      {
        "name": "üîí Advanced: Protect Range",
        "description": "Lock cells to prevent editing",
        "tool": "sheets_advanced",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "add_protected_range",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1:D1" },
          "description": "Protected header row"
        },
        "expectedBehavior": "Protects header from edits"
      },
      {
        "name": "üé® Advanced: Apply Banding",
        "description": "Apply alternating row colors",
        "tool": "sheets_advanced",
        "category": "core",
        "requiresAuth": true,
        "arguments": {
          "action": "apply_banding",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "range": { "a1": "Sheet1!A1:D100" },
          "headerColor": { "red": 0.26, "green": 0.52, "blue": 0.96 }
        },
        "expectedBehavior": "Applies zebra striping to table"
      },
      {
        "name": "üîÑ Pivot: Create Pivot Table",
        "description": "Create pivot table for data aggregation",
        "tool": "sheets_pivot",
        "category": "analytics",
        "requiresAuth": true,
        "arguments": {
          "action": "create",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "sourceRange": { "a1": "Sheet1!A1:D100" },
          "rows": ["Category"],
          "values": [{"field": "Revenue", "function": "SUM"}]
        },
        "expectedBehavior": "Creates pivot aggregating revenue by category"
      },
      {
        "name": "üîÑ Pivot: Refresh Data",
        "description": "Refresh pivot table with latest source data",
        "tool": "sheets_pivot",
        "category": "analytics",
        "requiresAuth": true,
        "arguments": {
          "action": "refresh",
          "spreadsheetId": "YOUR_TEST_SPREADSHEET_ID_HERE",
          "pivotId": "PIVOT_ID_FROM_CREATE"
        },
        "expectedBehavior": "Updates pivot with current data"
      },
      {
        "name": "üìú History: Search Operations",
        "description": "Search operation history by tool/action",
        "tool": "sheets_history",
        "category": "enterprise",
        "requiresAuth": false,
        "arguments": {
          "action": "search",
          "query": "sheets_values",
          "limit": 20
        },
        "expectedBehavior": "Returns operations matching 'sheets_values'"
      },
      {
        "name": "‚èÆÔ∏è History: Rollback Operation",
        "description": "Undo operation by rolling back",
        "tool": "sheets_history",
        "category": "enterprise",
        "requiresAuth": true,
        "arguments": {
          "action": "rollback",
          "operationId": "OPERATION_ID_FROM_LIST"
        },
        "expectedBehavior": "Reverts specific operation"
      }
    ],
    "testScenarios": [
      {
        "name": "Quick Smoke Test (2 min)",
        "description": "Verify basic connectivity and authentication",
        "steps": [
          "Run: üîê Auth: Check Status",
          "Run: üìú History: List Operations",
          "Run: ‚úÖ Confirm: Get Stats",
          "Verify: All return success responses"
        ]
      },
      {
        "name": "MCP Elicitation Test (5 min)",
        "description": "Test user confirmation UI (SEP-1036)",
        "steps": [
          "Run: ‚úÖ Confirm: Get Stats (verify stats endpoint)",
          "Run: ‚úÖ Confirm: Request User Approval (test interactive UI)",
          "Verify: Interactive form appears in Inspector UI",
          "Verify: Can approve/reject/modify plan",
          "Check: Elicitation capability in server capabilities"
        ]
      },
      {
        "name": "MCP Sampling Test (5 min)",
        "description": "Test AI-powered analysis (SEP-1577)",
        "steps": [
          "Setup: Ensure authenticated with Google OAuth",
          "Run: ü§ñ Analyze: Generate Formula",
          "Verify: AI generates valid Google Sheets formula",
          "Run: ü§ñ Analyze: Detect Patterns",
          "Verify: AI finds patterns, trends, anomalies",
          "Run: ü§ñ Analyze: Suggest Chart Type",
          "Verify: AI recommends appropriate chart types",
          "Check: Sampling capability in server capabilities"
        ]
      },
      {
        "name": "Full Tool Coverage (15 min)",
        "description": "Test all 25 tools with sample operations",
        "steps": [
          "Authenticate: Run üîê Auth: Start OAuth Flow",
          "Test Core: sheets_spreadsheet, sheets_sheet, sheets_values",
          "Test Analytics: sheets_analysis (data_quality, formula_audit)",
          "Test Enterprise: sheets_transaction, sheets_validation, sheets_conflict",
          "Test MCP Native: sheets_confirm, sheets_analyze, sheets_fix",
          "Verify: All tools return proper success/error responses"
        ]
      }
    ]
  },
  "resources": [
    {
      "uri": "cache://stats",
      "name": "Cache Statistics",
      "description": "Cache performance metrics and hit rates",
      "category": "performance"
    },
    {
      "uri": "cache://deduplication",
      "name": "Request Deduplication Stats",
      "description": "API call reduction through deduplication and result caching",
      "category": "performance"
    },
    {
      "uri": "conflict://active",
      "name": "Active Conflicts",
      "description": "Currently detected operation conflicts",
      "category": "enterprise"
    },
    {
      "uri": "metrics://performance",
      "name": "Performance Metrics",
      "description": "Server performance and operation metrics",
      "category": "observability"
    }
  ],
  "documentation": {
    "quickStart": {
      "authentication": {
        "required": true,
        "method": "OAuth 2.0",
        "steps": [
          "1. Run tool: sheets_auth with action: 'status' to check current auth state",
          "2. If not authenticated, run sheets_auth with action: 'login' to get OAuth URL",
          "3. Open the returned authUrl in your browser",
          "4. Complete Google OAuth flow (sign in + grant permissions)",
          "5. You'll be redirected to a success page",
          "6. Tokens are automatically saved to: ~/.config/servalsheets/tokens.enc",
          "7. Retry your original operation - authentication is now complete!"
        ],
        "tokenStorage": "~/.config/servalsheets/tokens.enc (encrypted with ENCRYPTION_KEY)",
        "troubleshooting": [
          "If ENCRYPTION_KEY not set: Generate with 'openssl rand -hex 32' and add to .env",
          "If tokens invalid: Run 'sheets_auth' action: 'logout' then re-authenticate",
          "If PERMISSION_DENIED: Check OAuth scopes include Google Sheets API"
        ]
      },
      "configuration": {
        "requiredEnvVars": {
          "GOOGLE_CLIENT_ID": "Your Google OAuth Client ID from Google Cloud Console",
          "GOOGLE_CLIENT_SECRET": "Your Google OAuth Client Secret",
          "ENCRYPTION_KEY": "Generate with: openssl rand -hex 32 (64 hex chars / 32 bytes)",
          "GOOGLE_TOKEN_STORE_PATH": "Path to encrypted token file (default: ~/.config/servalsheets/tokens.enc)"
        },
        "optionalEnvVars": {
          "ALLOWED_ROOT_DIRS": "Comma-separated list of directories the server can access for file operations",
          "LOG_LEVEL": "Logging verbosity: debug, info, warn, error (default: info)",
          "CACHE_ENABLED": "Enable response caching (default: true)",
          "CIRCUIT_BREAKER_ENABLED": "Enable circuit breaker for fault tolerance (default: true)"
        },
        "rootDirectories": {
          "description": "Configure allowed directories for file operations (snapshots, exports, etc.)",
          "envVar": "ALLOWED_ROOT_DIRS",
          "example": "ALLOWED_ROOT_DIRS=/Users/yourname/Documents,/Users/yourname/Downloads,/tmp",
          "default": "If not set, uses: home directory, /tmp, current working directory",
          "security": "Server will reject file operations outside these directories"
        }
      },
      "testing": {
        "mcpFeatures": {
          "elicitation": {
            "tool": "sheets_confirm",
            "description": "Interactive user confirmation UI (MCP SEP-1036)",
            "testWith": "Request approval for multi-step operations",
            "expectedBehavior": "Opens interactive form in Inspector UI for user to approve/reject/modify operations"
          },
          "sampling": {
            "tool": "sheets_analyze",
            "description": "AI-powered data analysis (MCP SEP-1577)",
            "testWith": "Generate formulas, detect patterns, suggest charts",
            "expectedBehavior": "AI analyzes data and provides insights, formula suggestions, or chart recommendations"
          }
        },
        "sampleSpreadsheet": {
          "note": "Replace YOUR_TEST_SPREADSHEET_ID_HERE with an actual spreadsheet ID",
          "howToGetId": "Open Google Sheets ‚Üí URL: https://docs.google.com/spreadsheets/d/SPREADSHEET_ID_HERE/edit",
          "requiredPermissions": "Must have edit access to the spreadsheet"
        }
      }
    },
    "links": {
      "repository": "https://github.com/khill1269/servalsheets",
      "documentation": "https://github.com/khill1269/servalsheets#readme",
      "quickstart": "https://github.com/khill1269/servalsheets/blob/main/QUICKSTART.md",
      "oauthSetup": "https://github.com/khill1269/servalsheets/blob/main/docs/guides/OAUTH_USER_SETUP.md",
      "inspectorGuide": "https://github.com/khill1269/servalsheets/blob/main/docs/guides/MCP_INSPECTOR_TESTING_GUIDE.md",
      "mcpSpec": "https://spec.modelcontextprotocol.io",
      "mcpElicitation": "https://spec.modelcontextprotocol.io/specification/2025-11-25/seps/1036",
      "mcpSampling": "https://spec.modelcontextprotocol.io/specification/2025-11-25/seps/1577"
    }
  }
}
